{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuevo Registro Personal</title>
    <link rel="icon" type="image/x-icon" href="{% static 'img/favicon.ico' %}">
    <link rel="stylesheet" href="{% static 'css/bootstrap.css' %}">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">

    <style>
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { 
        -webkit-appearance: none; 
        margin: 0; 
        }

        input[type=number] { -moz-appearance:textfield; }
    </style>

</head>
<body>

    <div class="container-fluid">
        <div class="row flex-nowrap">
            {% include 'partials/sidebar_rrhh.html' %}
            <div class="col py-3 overflow-auto vh-100">
                <h1 class="text-center mt-3 fw-bold">Nuevo Registro</h1>
                <hr>
                <div class="container text-center">
                    <form class="row row-cols-md-4 my-5 justify-content-center" action="{% url 'nuevo-registro' %}" method="post">
                        {% csrf_token %} 
                            <div class="col-md">
                                <h3>Datos Personales</h3>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="nombrePersonal">Nombre Completo<strong class="text-danger">*</strong></label>
                                    <input class="form-control" type="text" name="nombrePersonal" id="nombrePersonal" placeholder="Ej: Juan José Vargas Perez" required autofocus>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="rut">RUT<strong class="text-danger">*</strong></label>
                                    <input class="form-control" type="text" name="rutPersonal" id="rut" pattern="[0-9]{8}-[0-9kK]{1}" maxlength="10" placeholder="Ej: 12345678-k" required>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="generoPersonal">Género<strong class="text-danger">*</strong></label>
                                    <select class="form-select" name="generoPersonal" id="generoPersonal" required>
                                        <option value="" selected>Seleccionar</option>
                                        <option value="Femenino">Femenino</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="Otro">Otro</option>
                                    </select>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="direccionPersonal">Dirección<strong class="text-danger">*</strong></label>
                                    <input class="form-control" type="text" name="direccionPersonal" id="direccionPersonal" placeholder="Ej: Antonio Varas 1200" required>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="telefonoPersonal"> Número de Teléfono<strong class="text-danger">*</strong></label>
                                    <br>
                                    <span class="validarTelefono text-danger"></span>
                                    <div class="input-group">
                                        <span class="input-group-text" id="telefonoPersonal">+569</span>
                                        <input class="form-control campoTelefono" type="number" name="telefonoPersonal" id="telefonoPersonal" placeholder="Ej: 44448888" minlength="8" maxlength="8"  required>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md">
                                <h3>Datos Laborales</h3>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="cargoPersonal">Cargo<strong class="text-danger">*</strong></label>
                                    <input class="form-control" type="text" name="cargoPersonal" id="cargoPersonal" placeholder="Ej: Operador" required>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="cargoSueldo">Sueldo<strong class="text-danger">*</strong></label>
                                    <input class="form-control" type="number" step="0.01" min="0" name="cargoSueldo" id="cargoSueldo" placeholder="Ej: 550602.27" required>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="fechaIngresoPersonal">Fecha Ingreso<strong class="text-danger">*</strong>
                                        <strong class="text-primary">mm/dd/yyyy</strong>
                                    </label>
                                    <input class="form-control" type="date" name="fechaIngresoPersonal" id="fechaIngresoPersonal" min="2001-11-22" required>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="areaPersonal">Área<strong class="text-danger">*</strong></label>
                                    <input class="form-control" type="text" name="areaPersonal" id="areaPersonal" placeholder="Ej: Logística" required>
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="departamento">Departamento<strong class="text-danger">*</strong></label>
                                    <input class="form-control" type="text" name="departamentoPersonal" id="departamento" placeholder="Ej: Reparto en Área" required>
                                </div>
                            </div>
                            <div class="col-md">
                                <h3>Contactos de Emergencia</h3>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="rutContacto">RUT</label>
                                    <input class="form-control" type="text" name="rutContacto" id="rutContacto" pattern="[0-9]{8}-[0-9kK]{1}" maxlength="10" placeholder="Ej: 12345678-2">
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="nombreContacto">Nombre Completo</label>
                                    <input class="form-control" type="text" name="nombreContacto" id="nombreContacto" placeholder="Ej: Fernanda Oyarzo">
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="relacionContacto">Relación con Personal</label>
                                    <input class="form-control" type="text" name="relacionContactoPersonal" id="relacionContacto" placeholder="Ej: Esposa">
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="telefonoContacto">Número de Teléfono</label>
                                    <br>
                                    <span class="validarTelefono text-danger"></span>
                                    <div class="input-group">
                                        <span class="input-group-text" id="telefonoContacto">+569</span>
                                        <input class="form-control campoTelefono" type="number" name="telefonoContacto" id="telefonoContacto" placeholder="Ej: 66778899" minlength="8" maxlength="8">
                                    </div>
                                </div>
                            </div>
                            <div class="col-md">
                                <h3>Cargas Familiares</h3>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="rutCarga">RUT</label>
                                    <input class="form-control" type="text" name="rutCarga" id="rutCarga" pattern="[0-9]{8}-[0-9kK]{1}" maxlength="10"  placeholder="Ej: 12345678-3">
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="nombreCarga">Nombre Completo</label>
                                    <input class="form-control" type="text" name="nombreCarga" id="nombreCarga" placeholder="Ej: Andrea Vargas">
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="parentesco">Parentesco</label>
                                    <input class="form-control" type="text" name="parentescoCarga" id="parentesco" placeholder="Ej: Hija">
                                </div>
                                <div class="form-group mb-3 text-start">
                                    <label class="form-label fw-bold" for="generoCarga">Género</label>
                                    <select class="form-select" name="generoCarga" id="generoCarga">
                                        <option value="" selected>Seleccionar</option>
                                        <option value="Femenino">Femenino</option>
                                        <option value="Masculino">Masculino</option>
                                        <option value="Otro">Otro</option>
                                    </select>
                                </div>
                            </div>
                        <button type="submit" class="btn btn-primary btn-lg mt-2 rounded-5">Guardar</button>
                    </form>
                </div>
            </div>
        </div>
    </div>
    
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script>
        // Obtener la fecha actual y hora actual para personal
        const fechaActual = new Date();
        // Ajustar la fecha y hora actual según la zona horaria de Chile
        const fechaActualChile = new Date(fechaActual.getTime() - (240 * 60000)).toISOString().split('T')[0];

        // Asignar la fecha actual como valor máximo del input:date fecha ingreso personal
        document.getElementById("fechaIngresoPersonal").max = fechaActualChile;

        // Validar Cantidad mímina y maxima de digitos en los input de numeros de telefonos del personal
        var camposTelefonos = document.querySelectorAll(".campoTelefono");
        var validarTelefonos = document.querySelectorAll(".validarTelefono");

        camposTelefonos.forEach((campoTelefono, index) => {
            campoTelefono.addEventListener("input", function() {
                if (this.value.length > this.maxLength) {
                    this.value = this.value.slice(0, this.maxLength); 
                } else if (this.value.length < this.minLength) {
                    validarTelefonos[index].innerHTML = "Debe contener 8 dígitos";
                } else {
                    validarTelefonos[index].innerHTML = "";
                };
            });
        });
    </script>
</body>
</html>